apply plugin: 'com.android.library'
apply plugin: 'com.baoyz.treasure'
def isEclipseProject() {
    return !project.file('src/main').exists()
}

def isRelease() {
    project.gradle.startParameter.taskNames.each { arg ->
        if (arg.contains("assembleDouyinCnRelease") || arg.contains("resguardDouyinCnRelease")) {
            return true
        }
    }
    return false
}

if (isRelease()) {
    if("true".equalsIgnoreCase(findProperty("isOpenMcImage"))) {
        apply plugin: 'McImage'
        McImageConfig {
            isCheck true //default true
            isCompress true //default true
            maxSize 1 * 1024 * 1024 //default 1MB
            isWebpConvert true //default true
            isJPGConvert true //default true
            enableWhenDebug false //default true
            isCheckSize false //default true
            mctoolsDir "$rootDir/tools"
        }
    }
}

android {
    compileSdkVersion COMPILE_SDK_VERSION as int
    buildToolsVersion BUILD_TOOLS_VERSION

    useLibrary 'org.apache.http.legacy'

    if (isEclipseProject()) {
        sourceSets {
            main {
                manifest.srcFile 'AndroidManifest.xml'
                java.srcDirs = ['src']
                resources.srcDirs = ['src']
                aidl.srcDirs = ['src']
                renderscript.srcDirs = ['src']
                res.srcDirs = ['res']
                assets.srcDirs = ['assets']
                jniLibs.srcDirs = ['libs']
            }
        }
    }

    lintOptions {
        checkReleaseBuilds false
        abortOnError false
    }

}

dependencies {
    compile fileTree(dir: "libs", include: '*.jar', exclude: 'android-support-v4.jar')
}